<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SWIPENOW</title>
<link rel="preload" 
      href="/assests/SmoochSans-VariableFont_wght.woff2" 
      as="font" 
      type="font/woff2" 
      crossorigin>
    <link rel="icon" href="/assests/icon/favicon-96x96.png" sizes="any" type="image/x-icon">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css" integrity="sha512-2SwdPD6INVrV/lHTZbO2nodKhrnDdJK9/kg2XD1r9uGqPo1cUbujc+IYdlYdEErWNu69gVcYgdxlmVmzTWnetw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="/styling/pages/edit.css">
 <script src="https://cdn.onesignal.com/sdks/web/v16/OneSignalSDK.page.js" defer></script>
<script>
  window.OneSignalDeferred = window.OneSignalDeferred || [];
  OneSignalDeferred.push(async function(OneSignal) {
    await OneSignal.init({
      appId: "42d4b147-37f6-4d4b-90af-7b0727be1048",
    });

    // Ask the user to allow notifications
    const isPushEnabled = await OneSignal.isPushNotificationsEnabled();
    if (!isPushEnabled) {
      OneSignal.showSlidedownPrompt(); // Opens the permission dialog
    }
  });
</script>
</head>
<body>
    <div class="container">
        <div class="header">
           <div class="primary">
            <img class="logo floating white-glow" src="/assests/logo-removebg-preview.png" alt="SWIPENOW Logo">
           
            
           </div>
           </div>
         <div class="img-dropdown">
  <div class="dropdown-btn" id="dropdownBtn" onclick="saveProfilePic()">Select Image <span>↓</span></dix>

  <div class="dropdown-menu" id="dropdownMenu">

  <!-- Row 1 : Alex (Male) -->
  <div class="flex">
    <img src="/assests/pfp/2.png" data-name="Alex - Normal">
    <img src="/assests/pfp/headShock2.png" data-name="Alex - Shocked">
    <img src="/assests/pfp/headFocus2.png" data-name="Alex - Focused">
  </div>

  <!-- Row 2 : Ryan (Male) -->
  <div class="flex">
    <img src="/assests/pfp/head3.png" data-name="Ryan - Calm">
    <img src="/assests/pfp/3.png" data-name="Ryan - Smiling">
    <img src="/assests/pfp/headFocus3.png" data-name="Ryan - Focused">
  </div>

  <!-- Row 3 : Robot -->
  <div class="flex">
    <img src="/assests/pfp/headShock1.png" data-name="Robot - Alert">
    <img src="/assests/pfp/head1.png" data-name="Robot - Neutral">
    <img src="/assests/pfp/headFocus1.png" data-name="Robot - Processing">
  </div>

  <!-- Row 4 : Emma (Female) -->
  <div class="flex">
    <img src="/assests/pfp/headShock4.png" data-name="Emma - Shocked">
    <img src="/assests/pfp/head4.png" data-name="Emma - Normal">
    <img src="/assests/pfp/headFocus4.png" data-name="Emma - Focused">
  </div>

  <!-- Row 5 : Zombie -->
  <div class="flex">
    <img src="/assests/pfp/headFocus.png" data-name="Zombie - Focused">
    <img src="/assests/pfp/headShock.png" data-name="Zombie - Shocked">
    <img src="/assests/pfp/head.png" data-name="Zombie - Neutral">
  </div>

  <!-- Row 6 : Luna (Female) -->
  <div class="flex">
    <img src="/assests/pfp/head5.png" data-name="Luna - Normal">
    <img src="/assests/pfp/headFocus5.png" data-name="Luna - Focused">
    <img src="/assests/pfp/headShock5.png" data-name="Luna - Shocked">
  </div>

</div>

</div>
         </div>
<div class="info">
  <button class="username" id="username" >Guest_67</button>
  <button class="email" id="email" >Guest67@gmail.com</button>
  <button class="password" onclick="sendOtpAndRedirect('password')">********</button>
</div>


          <div class="buttons">
             <button onclick="gotoProfile()">Back</button>
            <button onclick="loggingOut()">Logout</button>
            <button id="delete">Delete</button>

          </div>
          <!-- <div class="flex1">

            <a href="aboutus.html">Know About Us</a>   
          </div> -->


          
 <script src="/global.js"></script>
  <script src="/scripting/services/home.js"></script>  
<script src="/scripting/utils/routing.js"></script>
 <script src="/scripting/services/profilepic.js"></script>  
 <script src="/scripting/API/apiHandler.js"></script>
<script>
  const btn = document.getElementById("dropdownBtn");
  const menu = document.getElementById("dropdownMenu");

  // Toggle dropdown
  btn.addEventListener("click", () => {
    menu.style.display = menu.style.display === "block" ? "none" : "block";
  });

  // Image click handler
  menu.addEventListener("click", (e) => {
    if (e.target.tagName === "IMG") {
      const name = e.target.dataset.name;
      btn.textContent = name + " ↓";
      menu.style.display = "none";
    }
  });

  // Close on outside click
  document.addEventListener("click", (e) => {
    if (!e.target.closest(".img-dropdown")) {
      menu.style.display = "none";
    }
  });
</script>

<script>
 document.addEventListener("DOMContentLoaded", () => {
  const username = localStorage.getItem("username");
  console.log(username);
  
  fetch(API.getProfile(username))
    .then(res => {
      if (!res.ok) throw new Error("Failed to fetch profile");
      return res.json();
    })
    .then(data =>{
      console.log(data);
      updateUIs(data)
    } )
    .catch(err => console.error(err));
});

function updateUIs(user) {
  // PROFILE INFO
  document.getElementById("email").textContent = `${user.email}`;
   document.getElementById("username").textContent = `@${user.username}`;
  

 
}

</script>






<script>
  const sendOtpAndRedirect = async (actionType) => {
  const email = document.querySelector(".email").innerText.trim();
  console.log("hello",email);
  
  try {
    const response = await fetch(API.sendOtp(email), {
      method: "POST",
    });

    if (!response.ok) {
      throw new Error("OTP send failed");
    }

    localStorage.setItem("otpEmail", email);
    localStorage.setItem("otpAction", actionType);

    window.location.href = "/pages/otp.html";

  } catch (error) {
    console.error(error);
    alert("Failed to send OTP");
  }
};

</script>


</body>
</html>